!function(){"use strict";const t=(t,e={})=>{const n=document.createElement(t);for(const t of Object.entries(e)){const[e,o]=t;switch(e){case"textContent":case"text":n.textContent=o;break;case"classList":case"class":for(const t of[].concat(o))n.classList.add(t);break;case"innerHTML":case"html":n.innerHTML=o;break;default:n.setAttribute(e,o)}}return n},e=t=>(t=>document.evaluate(t,document,null,0))(t).iterateNext(),n=t=>({on:(e,n)=>{t.addEventListener(e,n)}}),o=(t,e=document)=>e.querySelector(t),r=t=>o(`meta[property="${t}"]`),i=()=>{const t=r("og:image");if(!t)throw new Error("error getting canonical image");return t.content},c=()=>{try{const t=(()=>{const t=r("og:url");if(!t)throw new Error("error getting canonical URL");return new URL(t.content)})();return Number(t.searchParams.get("comic"))}catch(t){throw t.__="error getting canonical ID",t}};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function s(t,e,n,o){return new(n||(n=Promise))((function(r,i){function c(t){try{a(o.next(t))}catch(t){i(t)}}function s(t){try{a(o.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,s)}a((o=o.apply(t,e||[])).next())}))}var a=Object.freeze({__proto__:null,Contact:()=>{var t;const e=null!==(t=(()=>{const t=o(".topnav a[href^=mailto]").getAttribute("href");return new URL(t).searchParams.get("subject")})())&&void 0!==t&&t;if(!1!==e)return e;throw new Error("Contact subject not found")},Title:t=>{const{title:e}=t;if(e)return e;throw new Error("comic title not found")},RSS:()=>{try{return e("//body//comment()[contains(., 'rss-title')]").data.trim()}catch(t){throw t.__="RSS title not found",t}}});var l="butiwouldratherbereading",d="yu-dereader";const u=o("center table tbody"),h={title:e=>t("h2",{text:e}),RSS:e=>t("a",{classList:["rss"],html:e}),default:e=>t("span",{text:e})},f=(t,e="title")=>{var n;return(null!==(n=h[e])&&void 0!==n?n:h.default)(t)},p=(e,n)=>{const o=t("tr",{class:"egg"});o.appendChild(t("td",{colspan:3})),o.children[0].appendChild(t("div"));for(const t of[e,n])o.children[0].children[0].appendChild(t);u.appendChild(o)};function m(t){return s(this,void 0,void 0,(function*(){for(let e of t){const t=f(e.title),n=f(e.content,e.title);p(t,n)}}))}const v=t=>function(e){return s(this,void 0,void 0,(function*(){console.group(t),console.error(e),console.groupEnd()}))},g=(e,n,o)=>{const r=t("optgroup",{label:e});for(const e of n){const n=t("option");n.textContent=e.title,n.value=e.param,n.dataset.position=e.position,n.dataset.src=e.src?(i=e.src).includes(".")?i:i+".png":o,r.appendChild(n)}var i;return r};let w,b;const I=(t={})=>{var e;const n=new URL(window.location.href.replace(/\?.*$/,"")),{searchParams:o}=new URL(window.location.href);for(const r of["comic",l]){const i=null!==(e=t[r])&&void 0!==e?e:o.get(r);i&&n.searchParams.set(r,i)}return n.pathname.length<2&&(n.pathname="/index.php"),n};function y(t){var e;return s(this,void 0,void 0,(function*(){const n=null!==(e=I().searchParams.get(l))&&void 0!==e?e:"";b=t;for(const t of Array.from(b.options))if(t.value===n)return void(b.selectedIndex=t.index)}))}const D=t=>{const e=b.options[t].dataset,n=Number(w.style.transform.replace(/\D/g,""));w.style.transform=`rotateY(${(n+360)%720}deg)`,w.style.backgroundPosition=e.position,window.setTimeout(()=>{w.src=e.src},400)},x=t=>{b.selectedIndex=t.state,D(t.state)};const C=t=>{const e=b.options[t],n=I({[l]:e.value});D(e.index),window.history.pushState(e.index,document.title,n.toString())},A=t=>{let e;t.preventDefault();do{e=Math.floor(Math.random()*b.options.length)}while(e===b.selectedIndex);C(e),b.selectedIndex=e};function S(){return s(this,void 0,void 0,(function*(){w.setAttribute("title","DOUBLE CLICK FOR MORE AWESOME FUN TIMES!"),n(w).on("dblclick",A)}))}const R=t=>{t.preventDefault(),C(b.selectedIndex)};function E(){return s(this,void 0,void 0,(function*(){n(b).on("change",R)}))}function L(){return s(this,void 0,void 0,(function*(){for(let e=1;e<b.options.length;e++){const n=b.options[e].dataset.src;document.head.appendChild(t("link",{rel:"prefetch",href:n}))}}))}const k=t=>{t.preventDefault(),window.scroll({left:window.scrollX,top:o(`a[name=${d}]`).getBoundingClientRect().y,behavior:"smooth"})};function P(){return s(this,void 0,void 0,(function*(){o("#blogpostheader").appendChild(t("a",{name:d}));const e=o("a.rss");e.setAttribute("href","#"+d),e.addEventListener("click",k)}))}const O=(t,e,o)=>(function(t,e){s(this,void 0,void 0,(function*(){w=t;const n=["transform 800ms","background-position 0ms ease 400ms"].join(", ");w.style.backgroundImage=`url(${e})`,w.style.transition=n,w.dataset.canon=e}))}(t,e.src),Promise.resolve(o).then(y).then(()=>function(t){return s(this,void 0,void 0,(function*(){const e=b.selectedOptions[0],o=I({[l]:e.value,comic:t});window.history.replaceState(e.index,document.title,o.toString()),n(window).on("popstate",x)}))}(e.id)).then(()=>Promise.all([S(),E(),L(),P()])).catch(t=>{throw t.__="initializing interface",t}));var T={categories:["T-Rex and Pals","Other Friends"],defaults:{title:"",src:"",param:"",position:"0 0",category:"",catID:0},views:[{title:"The Canonical Cartoon",src:"",param:""},{title:"One Where T-Rex Got Assimilated",src:"assimilated"},{title:"One Where T-Rex Wears More",src:"clothes"},{title:"One Where T-Rex Swears More",src:"frig"},{title:"Something More Historically Accurate",src:"feathers"},{title:"The Last Dinosaur Comic Ever",src:"lastever"},{title:"Before the Special Effects Are Added"},{title:"One Done in Watercolours",src:"watercolours"},{title:"D.C. Comics",src:"batman"},{title:"Just About T-Rex",src:"moretrex"},{title:"About Pirates",src:"pirates"},{title:"Dr. McNinja",src:"mcninja"},{title:"Penny Arcade",src:"penny",position:"7px 8px",catID:1},{title:"Problem Sleuth",catID:1},{title:"XKCD",catID:1},{title:"Sweet Bro and Hella Jeff",src:"sbahj",catID:1},{title:"A Lesson Is Learned But the Damage Is Irreversible",src:"alil",catID:1},{title:"BRODYQUEST",src:"brodyquest.gif",catID:1},{title:"Buttercup Festival",catID:1},{title:"Daisy Owl",catID:1},{title:"Nedroid",catID:1},{title:"Pokey the Penguin",src:"pokey",param:"pokey",catID:1},{title:"Shortpacked!",catID:1},{title:"Wigu Adventures",src:"wigu",param:"wigu",catID:1},{title:"Wondermark",catID:1},{title:"Achewood",position:"0 30px",catID:1},{title:"Registered Weapon",catID:1},{title:"Sister Claire",catID:1},{title:"The RIAA Version of the Internet",src:"censored.gif",param:"theRIAAversionoftheinternet",catID:1}]};const _=(t,e)=>""===e.src?1:""===t.src||t.title<e.title?-1:1,M=t=>Array.from(t.keys()).reduce((e,n)=>(e.set(n,t.get(n).sort(_)),e),new Map),j=t=>{const e=new Map(t.categories.map(t=>[t,[]]));return t.views.forEach(n=>{const[o,r]=((t,e,n)=>{var o,r,i,c,s;const a=((t,e)=>{const{param:n=!1,title:o=e}=t;return""===n?n:o.toLowerCase().replace(/[^a-z]+/g,"")})(t,n.title);return[{title:null!==(o=t.title)&&void 0!==o?o:n.title,src:null!==(r=t.src)&&void 0!==r?r:a,param:null!==(i=t.param)&&void 0!==i?i:a,position:null!==(c=t.position)&&void 0!==c?c:n.position},e[null!==(s=t.catID)&&void 0!==s?s:n.catID]]})(n,t.categories,t.defaults);e.get(r).push(o)}),e};(()=>{const e=(()=>{const t=o(["body","center tbody","tr:nth-child(1)","td:nth-child(2) img:last-child"].join(" > "));if(t)return t;throw new Error("comic not found")})(),n={id:c(),src:i()};(function(t){return s(this,void 0,void 0,(function*(){const e=Object.keys(a);return Promise.all(e.map((function(e){return s(this,void 0,void 0,(function*(){const n=a[e](t);return{title:e,content:n}}))}))).catch(t=>{throw t.__="listing content eggs",t})}))})(e).then(m).catch(v("Eggs")),Promise.resolve(T).then(j).then(M).catch(t=>{throw t.__="listing views",t}).then(e=>function(e,n){return s(this,void 0,void 0,(function*(){const o=f("Views"),r=t("select");for(const t of e.keys())r.appendChild(g(t,e.get(t),n.src));return p(o,r),r}))}(e,n)).then(t=>{O(e,n,t)}).catch(v("Views"))})()}();
