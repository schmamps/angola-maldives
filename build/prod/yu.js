!function(){"use strict";const t=(t,e={})=>{const n=document.createElement(t);for(const t of Object.entries(e)){const[e,r]=t;switch(e){case"textContent":case"text":n.textContent=r;break;case"classList":case"class":for(const t of[].concat(r))n.classList.add(t);break;case"innerHTML":case"html":n.innerHTML=r;break;default:n.setAttribute(e,r)}}return n},e=t=>(t=>document.evaluate(t,document,null,0))(t).iterateNext(),n=t=>({on:(e,n)=>{t.addEventListener(e,n)}}),r=(t,e=document)=>e.querySelector(t),o=t=>r(`meta[property="${t}"]`),a="Pixelated",i="rendering",c=t=>new Promise((e=>{chrome.storage.local.set({[i]:t},(()=>{e(t)}))}));var s=Object.freeze({__proto__:null,get:()=>new Promise((t=>{chrome.storage.local.get([i],(e=>{var n;const r=!(null===(n=e[i])||void 0===n||!n);t({head:"Pixelated",val:r})}))})),set:c,createToggler:()=>{const e=t("input",{type:"checkbox",name:i}),n=t("label",{text:"pixelated"});return e.appendChild(n),e},getToggler:()=>r(`input[name=${i}]`),name:a,key:i});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function l(t,e,n,r){return new(n||(n=Promise))((function(o,a){function i(t){try{s(r.next(t))}catch(t){a(t)}}function c(t){try{s(r.throw(t))}catch(t){a(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,c)}s((r=r.apply(t,e||[])).next())}))}var d="(not found)";const u="Contact";var p=Object.freeze({__proto__:null,get:function(){var t;return l(this,void 0,void 0,(function*(){const e=r(".topnav a[href^=mailto]").getAttribute("href");return{head:"Contact",val:null!==(t=new URL(e).searchParams.get("subject"))&&void 0!==t?t:d}}))},name:u,key:"contact"});var h=Object.freeze({__proto__:null,get:function(){return l(this,void 0,void 0,(function*(){try{return{head:"RSS",val:e("//body//comment()[contains(., 'rss-title')]").data.trim()}}catch(t){return{head:"RSS",val:d}}}))},name:"RSS",key:"rss"});const v=()=>{const t=o("og:image");if(!t)throw new Error("error getting canonical image");return t.content},f=()=>{try{const t=(()=>{const t=o("og:url");if(!t)throw new Error("error getting canonical URL");return new URL(t.content)})();return Number(t.searchParams.get("comic"))}catch(t){throw t.__="error getting canonical ID",t}},m=(()=>{const t=r(["body","center tbody","tr:nth-child(1)","td:nth-child(2) img:last-child"].join(" > "));if(t)return t;throw new Error("comic not found")})(),g={id:f(),src:v()},w="Title";var y=Object.freeze({__proto__:null,get:function(){var t;return l(this,void 0,void 0,(function*(){return{head:"Title",val:null!==(t=m.title)&&void 0!==t?t:d}}))},name:w,key:"title"}),b={categories:["T-Rex and Pals","Other Friends"],defaults:{title:"",src:"",param:"",position:"0 0",category:"",catID:0},views:[{title:"The Canonical Cartoon",src:"",param:""},{title:"One Where T-Rex Got Assimilated",src:"assimilated"},{title:"One Where T-Rex Wears More",src:"clothes"},{title:"One Where T-Rex Swears More",src:"frig"},{title:"Something More Historically Accurate",src:"feathers"},{title:"The Last Dinosaur Comic Ever",src:"lastever"},{title:"Before the Special Effects Are Added"},{title:"One Done in Watercolours",src:"watercolours"},{title:"D.C. Comics",src:"batman"},{title:"Just About T-Rex",src:"moretrex"},{title:"About Pirates",src:"pirates"},{title:"Dr. McNinja",src:"mcninja"},{title:"Penny Arcade",src:"penny",position:"7px 8px",catID:1},{title:"Problem Sleuth",catID:1},{title:"XKCD",catID:1},{title:"Sweet Bro and Hella Jeff",src:"sbahj",catID:1},{title:"A Lesson Is Learned But the Damage Is Irreversible",src:"alil",catID:1},{title:"BRODYQUEST",src:"brodyquest.gif",catID:1},{title:"Buttercup Festival",catID:1},{title:"Daisy Owl",catID:1},{title:"Nedroid",catID:1},{title:"Pokey the Penguin",src:"pokey",param:"pokey",catID:1},{title:"Shortpacked!",catID:1},{title:"Wigu Adventures",src:"wigu",param:"wigu",catID:1},{title:"Wondermark",catID:1},{title:"Achewood",position:"0 30px",catID:1},{title:"Registered Weapon",catID:1},{title:"Sister Claire",catID:1},{title:"The RIAA Version of the Internet",src:"censored.gif",param:"theRIAAversionoftheinternet",catID:1}]};const x="View",D=(t,e)=>""===e.src?1:""===t.src||t.title<e.title?-1:1;var I=Object.freeze({__proto__:null,get:function(){return l(this,void 0,void 0,(function*(){const t=x;try{return{head:t,val:(e=(t=>{const e=new Map(t.categories.map((t=>[t,[]])));return t.views.forEach((n=>{const[r,o]=((t,e,n)=>{var r,o,a,i,c;const s=((t,e)=>{const{param:n=!1,title:r=e}=t;return""===n?n:r.toLowerCase().replace(/[^a-z]+/g,"")})(t,n.title);return[{title:null!==(r=t.title)&&void 0!==r?r:n.title,src:null!==(o=t.src)&&void 0!==o?o:s,param:null!==(a=t.param)&&void 0!==a?a:s,position:null!==(i=t.position)&&void 0!==i?i:n.position},e[null!==(c=t.catID)&&void 0!==c?c:n.catID]]})(n,t.categories,t.defaults);e.get(o).push(r)})),e})(b),Array.from(e.keys()).reduce(((t,n)=>(t.set(n,e.get(n).sort(D)),t)),new Map))}}catch(e){return{head:t,val:new Map}}var e}))},name:x,key:"views"});const _=()=>["title","contact","rss","rendering","views"];var C=Object.freeze({__proto__:null,keys:_,title:y,contact:p,rss:h,rendering:s,views:I});const k=r("center table tbody"),A=(e,n)=>{const r=t("tr",{class:"egg"}),o=t("td",{colspan:3}),a=t("div"),i=t("h2",{text:e});var c;a.appendChild(i),a.appendChild("string"!=typeof(c=n)?c:t("span",{text:c})),o.appendChild(a),r.appendChild(o),k.appendChild(r)},L=t=>{const e="pixel";t?m.classList.add(e):m.classList.remove(e)},S=t=>{t.preventDefault();const e=t.target.checked;c(e).then(L)};let O;const R="butiwouldratherbereading",E=(e,n)=>{var r,o;const a=t("option",{text:e.title});var i;return a.value=null!==(r=e.param)&&void 0!==r?r:"",a.selected=a.value==n,a.dataset.position=null!==(o=e.position)&&void 0!==o?o:"0 0",a.dataset.src=e.src?(i=e.src).includes(".")?i:`${i}.png`:g.src,a},P=(e,n,r)=>{const o=t("optgroup",{label:n});for(const t of e.get(n)){const e=E(t,r);o.appendChild(e)}return o},T=(t={})=>{var e,n;const r=new URL(window.location.href),{searchParams:o}=new URL(window.location.href);r.pathname="index.php",r.search="";for(const a of["comic",R]){const i=null!==(n=null!==(e=t[a])&&void 0!==e?e:o.get(a))&&void 0!==n&&n;i&&r.searchParams.set(a,i)}return r},j=t=>{const{dataset:e}=O.options[t],n=Number(m.style.transform.replace(/\D/g,""));m.style.transform=`rotateY(${(n+360)%720}deg)`,m.style.backgroundPosition=e.position,window.setTimeout((()=>{m.src=e.src}),400)},M=t=>{O.selectedIndex=t.state,j(t.state)};const U=t=>{const e=O.options[t],n=T({[R]:e.value});j(e.index),window.history.pushState(e.index,document.title,n.toString())},W=t=>{t.preventDefault(),U(t.target.selectedIndex)},z=t=>{let e;t.preventDefault();do{e=Math.floor(Math.random()*O.options.length)}while(e===O.selectedIndex);U(e),O.selectedIndex=e};const B=e=>{const n=(e=>t("link",{rel:"prefetch",href:e}))(e);document.head.appendChild(n)};var N=Object.freeze({__proto__:null,contact:A,rendering:(e,n)=>{const r=t("label"),o=t("span",{text:"pixelated"}),a=(e=>{const n=t("input",{type:"checkbox",id:"pixelated-rendering"});return n.checked=e,n.addEventListener("change",S),n})(n);r.appendChild(o),r.appendChild(a),L(n),A(e,r)},rss:(e,n)=>{const o=(()=>{const e="yu-dereader",n=t("a",{name:e});return r("#blogpostheader").appendChild(n),e})(),a=t("a",{html:n,href:`#${o}`});A(e,a)},title:A,views:(e,r)=>{O=(e=>{var n;const r=t("select"),o=null!==(n=new URL(window.location.href).searchParams.get(R))&&void 0!==n?n:"";for(const t of Array.from(e.keys())){const n=P(e,t,o);r.appendChild(n)}return r})(r),O.addEventListener("change",W);const o=t("label"),a=t("span",{text:"select a view"});o.appendChild(a),o.appendChild(O),function(){l(this,void 0,void 0,(function*(){const t=["transform 800ms","background-position 0ms ease 400ms"].join(", ");m.style.backgroundImage=`url(${g.src})`,m.style.transition=t,m.setAttribute("title","DOUBLE CLICK FOR MORE AWESOME FUN TIMES!")}))}(),function(){l(this,void 0,void 0,(function*(){n(m).on("dblclick",z)}))}(),function(){l(this,void 0,void 0,(function*(){const t=O.selectedOptions[0],e=T({[R]:t.value,comic:g.id});window.history.replaceState(t.index,document.title,e.toString()),n(window).on("popstate",M)}))}(),function(t){l(this,void 0,void 0,(function*(){Array.from(t).slice(1).map((t=>t.dataset.src)).forEach(B)}))}(O.options),A(e,o)}});(()=>{for(const t of["title","contact","rss","rendering","views"]){const e=C[t].get,n=N[t];e().then((t=>n(t.head,t.val)))}})()}();
